{% extends "base.html" %}
{% load lenx %}

{% block scripts %}
<script type="text/javascript" src="{% media_url %}/js/jquery.js"></script>

<script type="text/javascript">

    jQuery.fn.highlight = function(b) { 
        function a(e,j) { 
            var l=0;
            if(e.nodeType==3) { 
                var k=e.data.toUpperCase().indexOf(j);
                if(k>=0) { 
                    var h=document.createElement("span");
                    h.className="highlight";
                    var f=e.splitText(k);
                    var c=f.splitText(j.length);
                    var d=f.cloneNode(true);
                    h.appendChild(d);
                    f.parentNode.replaceChild(h,f);
                    l=1;
                }
            } else { 
                if(e.nodeType==1&&e.childNodes&&!/(script|style)/i.test(e.tagName)) { 
                    for(var g=0;g<e.childNodes.length;++g) { 
                        g+=a(e.childNodes[g],j);
                    }
                }
            }
            return l;
        }
        return this.each( function(){a(this,b.toUpperCase())})
    };
    jQuery.fn.removeHighlight=function() { 
        return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;with(this.parentNode){replaceChild(this.firstChild,this);normalize()}}).end();
    };
    var locSet = [];

    $(document).ready(function() {
        if(1) return;
        var match;
        $('#loading').show();
        for(var i=0; i<Math.min(locSet.length, 100); i++) {
            match = new RegExp(locSet[i]).exec($('#TexteOnly').text())
            if(match) {
                $('#TexteOnly').highlight(match[0]);
            } else {
                alert(locSet[i]+' - '+i);
            }
        }
        $('#loading').hide();
    });
</script>
{% endblock %}

{% block main %}

<h2>docView for {{ doc.title }} ({{ doc.eurlexid }})</h2>

<fieldset class="rel"><legend>Stats and related docs</legend>
    <h4>Cutoff: {{ cutoff }}</h4>
    <h4>Pippies: {{ len }}</h4>
    <ul>
    {% for dd in related %}
        <li>{{ dd.eurlexid }}</li>
    {% endfor %}
    </ul>
</fieldset>


{{ content|safe }}


{% endblock %}
